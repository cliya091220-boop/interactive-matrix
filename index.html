<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8"/>
<title>Mapping of Included Studies — Interactive Matrix</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>
  :root{
    /* Base color palette (can be precisely replaced to match the paper). */
    --qual:#3b6fb6;   /* Study design: Qualitative (Blue) */
    --quant:#6aa84f;  /* Study design: Quantitative (Green) */
    --mix:#f39c12;    /* Study design: Mixed (Orange) */

    --q-low:#cf4c4c;  /* MMAT: 0–1 (Red) */
    --q-mid:#f2a655;  /* MMAT: 2–3 (Orange) */
    --q-high:#7fb97f; /* MMAT: 4–5 (Green) */

    /* Participant perspectives */
    --pp-parent:#3b6fb6;   /* Parents = Blue */
    --pp-child:#6aa84f;    /* Children = Green */
    --pp-both:#f39c12;     /* Both = Orange */

    /* Stage of life/illness */
    --st-healthy:#3b6fb6;          /* Healthy = Blue */
    --st-elderly:#6aa84f;          /* Elderly = Green */
    --st-ill:#f39c12;              /* Ill or dependent = Orange */
    --st-eol:#6b4ba6;              /* EOL or terminally ill = Purple */
    --st-deceased:#b33a3a;         /* Deceased = Dark Red */
    --st-na:#bfbfbf;               /* Not mentioned or across lifespan/across = Grey */

    /* Focus of death & dying communication */
    --fc-parents:#3b6fb6;          /* Parents' */
    --fc-children:#6aa84f;         /* Children's (use Green to distinguish)*/
    --fc-both:#f39c12;             /* Parents & Children */
    --fc-other:#6b4ba6;            /* Other family members = Purple */

    --grid:#e9edf2;
--diag-color:#e9edf2;   /* diagonal line color（slightly darker than --grid） */
--diag-thick:2px;       /* diagonal line thickness */
}
  :root{
    /* Fixed ColumnWidth */
    --w-group: 140px;   /* Group Column */
    --w-theme: 260px;   /* Theme Column */
    --w-study: 46px;    /* Every StudyID Column */
  }

  table{ border-collapse:separate; border-spacing:0; width:max-content; min-width:100%; table-layout:fixed; }
  th, td{ border:1px solid var(--grid); padding:6px 8px; background:#fff; white-space:nowrap; font-size:13px; box-sizing:border-box; overflow:hidden; }
  th{ background:#fafbfe; position:sticky; top:0; z-index:3; }
/* 专门提高表头(第一行)的层级，并加一条底部阴影分隔线 */
thead th{
  z-index: 10;              /* 高于左侧冻结列的 z-index=6/7 */
  background:#fafbfe;       /* 不透明底色，遮住下方内容 */
  box-shadow: 0 2px 0 rgba(0,0,0,.04);
}

/* 如果你用了斜线表头单元格（.diag），也抬高一下层级 */
thead th.diag{ z-index: 11; }

/* Wrap text only in the Group column (first column) for body rows; leave the header unchanged. */
tbody td.rowhead{
  white-space: normal;       /* Allow wrapping; override global settings. nowrap */
  word-break: break-word;    /* Break long words at boundaries. */
  hyphens: auto;             /* Enable automatic hyphenation for English (when supported by the browser). */
  overflow: visible;         /* Prevent clipping by hidden */
  line-height: 1.25;         /* Slightly tighter line spacing; adjust as needed. */
}

/* If the column is in Chinese, use this line instead.： */
/* tbody td.rowhead{ word-break: break-all; white-space: normal; overflow: visible; } */


  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; margin:18px;}
  h1{font-size:20px;margin:0 0 10px}
  .toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin:8px 0 10px}
  .btn{padding:6px 10px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer}
  .btn.active{border-color:#333}

.subttl{
  margin: 4px 0 10px;
  font-size: 16px;
  font-weight: 600;
}

.note{
  margin: 6px 0 10px;
  font-size: 12px;
  color:#555;
}
.note sup{ font-size: 10px; }

  .legend{display:flex;flex-wrap:wrap;gap:12px;margin:6px 0 12px}
  .legend .item{display:flex;align-items:center;gap:6px}
  .sw{width:14px;height:14px;border-radius:3px;border:1px solid rgba(0,0,0,.2)}

/* 让 .wrap 同时承担横向 + 纵向滚动（sticky 最稳） */
.wrap{
  position: relative;
  overflow-x: auto;                 /* 横向滚动 */
  overflow-y: auto;                 /* ✅ 改为 auto，让它成为纵向滚动容器 */
  max-height: calc(100vh - 180px);  /* ✅ 给个高度，让里面可以纵向滚动；180px 够放标题/工具条，按需调 */
  border:1px solid #eee;
  border-radius:8px;
}


  /* Fix the widths and freeze the first two columns. */
  th.rowhead, td.rowhead { width: var(--w-group); min-width: var(--w-group); max-width: var(--w-group); position:sticky; left:0; background:#fafbfe; z-index:2; }
  th.rowhead.second, td.rowhead.second { width: var(--w-theme); min-width: var(--w-theme); max-width: var(--w-theme); position:sticky; left: var(--w-group); background:#fafbfe; z-index:2; }
  .corner{ left:0; z-index:4 }
  .corner2{ left: var(--w-group); z-index:4 }

  /* tfoot merge the first two columns (spanning Group and Theme) */
  th.rowhead.span2{
    position:sticky;
    left:0;
    width: calc(var(--w-group) + var(--w-theme));
    min-width: calc(var(--w-group) + var(--w-theme));
    max-width: calc(var(--w-group) + var(--w-theme));
    background:#fbfcff; z-index:3; text-align:left;
  }

  /* Set a uniform/fixed width for the Study ID column */
  th.col-study, td.col-study { width: var(--w-study); min-width: var(--w-study); max-width: var(--w-study); }

  .cell{width:26px;height:22px;text-align:center;vertical-align:middle;padding:0}
  .mark{display:inline-block;width:30px;height:30px;border-radius:3px;border:1px solid rgba(0,0,0,.2)}
  .empty{background:#fff}
  tfoot th, tfoot td{ position: static; bottom:auto; }
  .num{text-align:right}

/* Diagonal header: draw it only inside the Theme/Report ID <th>, with strictly symmetric left–right spacing. */
:root{
  --diag-color:#e9edf2;  /* diagonal line color */
  --diag-thick:2px;      /* diagonal line thickness */
  --diag-gap-x:12px;     /* Symmetric side spacing: Theme left padding = Report ID right padding.*/
  --diag-gap-y:8px;      /* Top/bottom spacing (independently adjustable). */
}

th.diag{
  padding:0;
  overflow:hidden; /* Safety: even if absolutely positioned inner elements overflow, they’re clipped within the cell. */
}

th.diag .diagbox{
  position:relative;
  width:100%;
  min-height:48px;
  padding: var(--diag-gap-y) var(--diag-gap-x);
  box-sizing:border-box;

  /* Draw a diagonal (\) from top-left to bottom-right using a background gradient; it won’t spill into other cells. */
  background-image: linear-gradient(
    45deg,
    transparent calc(50% - var(--diag-thick)/2),
    var(--diag-color) 0,
    transparent calc(50% + var(--diag-thick)/2)
  );
  background-size:100% 100%;
  background-repeat:no-repeat;
}

/* Bottom-left (Theme): constrain to the left half; distance to the bottom and left edges = --diag-gap (ensured by .diagbox padding */
th.diag .bl{
  position:absolute;
  left:0;                /* Together with .diagbox padding, equals --diag-gap from the left border.*/
  right:70%;
  bottom:30%;              /* Together with .diagbox padding, equals --diag-gap from the bottom border. */
  white-space:nowrap;
  z-index:1;
}

/* Top-right (Report ID): constrain to the right half; distance to the top and right edges = --diag-gap.*/
th.diag .tr{
  position:absolute;
  left:50%;
  right:5%;               /* With .diagbox padding, equals --diag-gap from the right border. */
  bottom:30%;                 /* With .diagbox padding, equals --diag-gap from the top border. */
  text-align:right;
  white-space:nowrap;
  z-index:1;
}

/* === Z-INDEX FIX（防止横向滚动时右侧研究编号盖住左上角两列表头）=== */

/* 先给“研究编号”那一列的表头一个较低层级（用更高特异性选择器覆盖 thead th 的 10） */
thead th.col-study.study-head{
  z-index: 9;               /* 低于全局 thead th=10，也低于下面我们给 corner 的 49/50 */
}

/* 把左上角两格（冻结的前两列表头）抬到最高层，永远在最上面 */
thead th.rowhead.corner{
  z-index: 50;              /* 最高：既压过 thead th=10，也压过 diag=11 */
  background:#fafbfe;       /* 确保底色不透明，完全遮挡下面内容 */
}

thead th.rowhead.second.corner2{
  z-index: 49;              /* 比第一格略低 1，避免两格在交界处互相压线出锯齿 */
  background:#fafbfe;
}

/*（可选）给第二格右侧加一条微弱的分隔线，横向滚动时视觉更干净 */
thead th.rowhead.second.corner2{
  box-shadow: 2px 0 0 rgba(0,0,0,.04);
}


/* Fixed First Column（Group） */
th.rowhead:first-child,
td.rowhead:first-child {
  position: sticky;
  left: 0;
  background:#fafbfe;
  z-index: 5; /* Set a higher stacking level than regular cells (above standard z-index). */
}

/* Freeze the second column (Theme). */
th.rowhead.second,
td.rowhead.second {
  position: sticky;
  left: var(--w-group);  /* Match the width of the First column. */
  background:#fafbfe;
  z-index: 5;
}

/* Ensure each “Report ID” header remains clearly legible on the colored background. */
th.col-study.study-head{
  color: #fff;                 /* white text */
  text-shadow: 0 1px 0 rgba(0,0,0,.25); /* subtle outline to improve legibility on light colors */
}

/* adjust font style only for the Report ID header cells */
th.col-study.study-head{
  font-size: 14px;     /* change font size: e.g., 12px / 14px */
  font-weight: 700;    /* change weight: 400 normal, 600 semibold, 700 bold */
  /* optional: use tabular/lining numerals for cleaner numeric alignment */
  font-variant-numeric: tabular-nums; 
  line-height: 1.1;    /* optional: tighten line-height to reduce wrapping */
  letter-spacing: 0;   /* optional: fine-tune letter-spacing (tracking) */
}

/* === Row highlight (when hovering the Theme cell) === */
tbody tr.hl td { 
  background: #f7f7f7;             /* Regular cells in the row: pale grey background. */
}

/* The two sticky columns need their own stacking layer; otherwise the default row background will cover them. */
tbody tr.hl td.rowhead { 
  background: #eef2f7;             /* Group Column（First Column）Tint the highlight slightly toward blue. */
}
tbody tr.hl td.rowhead.second { 
  background: #e9edf4;             /* Highlight color for the Theme column (second column). */
}

/* Color chips/blocks remain unchanged (keep their borders/fills), unaffected by the row background. */
tbody tr.hl td .mark {
  /* No recoloring needed; for extra emphasis, add a subtle shadow. */
  box-shadow: 0 0 0 1px rgba(0,0,0,.05) inset;
}

/* ---- 固定右下角的单位徽章 ---- */
#orgBadge{
  position: fixed;
  right: 16px;   /* 保持贴右 */
  top: 16px;     /* 改为贴上 */
  width: 110px;            /* 徽章显示宽度，可按需改 */
  height: auto;            /* 等比缩放 */
  z-index: 9999;           /* 盖在最上层 */
  user-select: none;       /* 不能被误选中 */
  -webkit-user-drag: none; /* Safari/Chrome 禁止拖拽图像 */
  pointer-events: none;    /* 不挡住页面里的按钮/滚动等交互 */
}
@media (max-width: 520px){
  #orgBadge{ width: 84px; } /* 手机上自动小一点（可选） */
}

/* === FINAL stacking order（放在 CSS 最后）===
   100: 左上角第一格（Group）
    99: 左上角第二格（Theme）
    12: 其它表头（thead th 的默认层级）
     8: “研究编号”这一行里的每个列头（避免盖住左上两格）
     6: 冻结的前两列的正文单元格
*/

/* 提高所有 thead th 的基准层级，确保压住正文 */
thead th{ z-index: 12; }

/* 降低“研究编号”这一行所有列头（不再依赖 .study-head） */
thead th.col-study{ z-index: 8; }

/* 左上两格永远在最上面 */
thead th.rowhead.corner{ z-index: 100 !important; }
thead th.rowhead.second.corner2{ z-index: 99 !important; }

/* 冻结的前两列（正文部分）各自单独的层，防止被整行 hover 背景盖住 */
tbody td.rowhead,
tbody td.rowhead.second{ z-index: 6; }

/* While the intro overlay is visible, prevent page scrolling */
body.no-scroll { overflow: hidden; }

  /* Intro overlay：移动端可滚动 + 安全滚动边界 */
#intro-overlay{
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;  /* 防止橡皮筋把滚动传到底层页面 */
}

/* 内层卡片限制在视口内并单独可滚动 */
#intro-overlay > div{
  position: relative;             /* 让右上角关闭按钮可绝对定位 */
  max-height: 88vh;               /* 卡片高度不超过视口 */
  overflow: auto;                 /* 卡片内可以纵向滚动 */
  -webkit-overflow-scrolling: touch;
}

/* 右上角关闭按钮样式（可调） */
#intro-overlay .close-x{
  position: absolute; top: 8px; right: 8px;
  width: 32px; height: 32px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,.35);
  background: rgba(255,255,255,.15);
  color: #fff; font-size: 20px; line-height: 30px;
  text-align: center; cursor: pointer;
}
#intro-overlay .close-x:active{ transform: scale(.98); }

  
</style>
</head>
<body>
<!-- ===== Intro / How-to Overlay for the Matrix ===== -->
<div id="matrix-intro"
     role="dialog" aria-modal="true" aria-labelledby="mx-intro-title" aria-describedby="mx-intro-desc"
     style="
       position: fixed; inset: 0; z-index: 9999;
       display: flex; flex-direction: column; align-items: center; justify-content: center;
       background: rgba(0,0,0,0.80); color: #fff; text-align: left; padding: 24px;
       font-family: inherit;
     ">
  <div style="
        width: min(880px, 92vw);
        background: rgba(255,255,255,0.06);
        border: 1px solid rgba(255,255,255,0.15);
        border-radius: 14px;
        backdrop-filter: blur(6px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.35);
        padding: clamp(16px, 4vw, 28px);
      ">
    <button id="intro-close" class="close-x" aria-label="Close">×</button>
    <h2 id="mx-intro-title" style="margin: 0 0 8px; font-size: clamp(18px, 2.6vw, 24px); font-weight: 700;">
      Welcome to the Interactive Matrix of Included Studies
    </h2>

    <p id="mx-intro-desc" style="margin: 0 0 14px; line-height: 1.6; font-size: clamp(14px, 2.1vw, 16px); opacity: 0.95;">
      This matrix maps each included study (columns) against findings (rows). Use the toolbar to recolor and sort columns, and hover cells for details.
    </p>

    <div style="display: grid; grid-template-columns: 1fr; gap: 10px; margin: 12px 0 16px;">
      <div style="background: rgba(255,255,255,0.04); border: 1px dashed rgba(255,255,255,0.25); border-radius: 10px; padding: 12px;">
        <strong>How to use</strong>
        <ul style="margin: 8px 0 0 18px; line-height: 1.6; font-size: clamp(14px, 2.1vw, 16px);">
          <li>Use the <b>toolbar</b> to switch color modes: <i>MMAT Quality</i>, <i>Study Design</i>, <i>Participant perspectives</i>, <i>Stage</i>, <i>Focus</i>.</li>
          <li>Click <b>“Sort by current color”</b> to group study columns by the active color buckets; click <b>“Reset”</b> to restore Study ID order.</li>
          <li>The <b>first two columns</b> (Group, Theme) are frozen; scroll both ways to explore the matrix.</li>
          <li><b>Hover</b> any colored cell or header for a tooltip with study/design/MMAT and, when available, data-type/perspective/focus.</li>
          <li>In <b>MMAT</b> mode, right-side columns show per-theme <i>distribution</i> and <i>Density</i>; the footer shows per-study <i>Themes contributed</i> and <i>Data richness</i>.</li>
          <li>Refer to the <b>legend</b> below the toolbar to read the color mappings for the current mode.</li>
        </ul>
      </div>

      <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-end;">
        <label style="display:flex; align-items:center; gap:8px; font-size: 14px; opacity: 0.95; cursor: pointer;">
          <input id="mx-intro-dontshow" type="checkbox" style="transform: scale(1.2);" />
          Don’t show this guide next time
        </label>
        <button id="mx-intro-start-btn"
                style="
                  padding: 10px 18px; font-size: 15px; font-weight: 600; cursor: pointer;
                  border: 1px solid rgba(255,255,255,0.25); border-radius: 10px;
                  background: #ffffff; color: #111; transition: transform .05s ease;
                "
                onmousedown="this.style.transform='scale(0.98)';"
                onmouseup="this.style.transform='scale(1)';">
          Start exploring
        </button>
      </div>
    </div>

    <div style="opacity: 0.8; font-size: 12px; text-align: right;">
      Tip: Press <kbd>Esc</kbd> to close this guide.
    </div>
  </div>
</div>
<!-- ===== /Intro Overlay ===== -->


<!-- 单位徽章：把下面的 PASTE_BASE64_HERE 替换为你的 PNG 的 Base64 字符串 -->
<img
  id="orgBadge"
  alt="UMCG"
  src="data:image/png;base64,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"
/>

  <h1>Mapping of Included Studies — Interactive</h1>

  <div class="toolbar">
    <!-- Order: MMAT (default)→ Study Design → Perspectives → Stage → Focus -->
    <button class="btn active" data-mode="mmat">MMAT Quality</button>
    <button class="btn" data-mode="design">Study Design</button>
    <button class="btn" data-mode="persp">Participant perspectives</button>
    <button class="btn" data-mode="stage">Stage of life/illness</button>
    <button class="btn" data-mode="focus">Focus of death & dying</button>
  </div>

<button class="btn" id="btnSortColor">Sort by current color</button>
<button class="btn" id="btnSortReset">Reset to StudyID order</button>

<h2 id="view-title" class="subttl"></h2>

  <div id="legend" class="legend"></div>

  <div class="wrap">
    <table id="matrix"></table>
  </div>

<div id="note" class="note"></div>

<!-- ① 数据 + 你的表格渲染代码（必须在一个 <script> 里） -->
<script>

  /* ===== Data（Long table）：Replace with your real data. rows =====
     Column：Group, Theme, StudyID, Design, MMAT, Perspective, Stage, Focus
     Perspective：Parents | Children | Both
     Stage：Healthy | Elderly | Ill or dependent | EOL or terminally ill | Deceased | Not mentioned or across lifespan
     Focus：Parents | Children | Parents & Children | Other family member
  */
  let rows = [
   {Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"1", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Not mentioned or across lifespan",  Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"1", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Not mentioned or across lifespan",   Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"1", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Not mentioned or across lifespan",  Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator",  StudyID:"1", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Not mentioned or across lifespan",  Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"2", Design:"Quantitative",  MMAT:1, Perspective:"Children",  Stage:"EOL or terminally ill",  Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"3. Adjustment and Coping", StudyID:"2", Design:"Quantitative",  MMAT:1, Perspective:"Children",  Stage:"EOL or terminally ill",  Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"3. Adjustment and Coping", StudyID:"3", Design:"Quantitative",  MMAT:1, Perspective:"Children",  Stage:"EOL or terminally ill", Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"3. Adjustment and Coping", StudyID:"4", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Not mentioned or across lifespan", Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"1. Affective Attitude", StudyID:"5", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill", Focus:"Children"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"5", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill", Focus:"Children"},
{Group:"Familial factors", Theme:"4. Family relationships", StudyID:"5", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill", Focus:"Children"},
{Group:"Familial factors", Theme:"5. Family norms and communication patterns", StudyID:"5", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill", Focus:"Children"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"5", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill", Focus:"Children"},
{Group:"Impacts of Communication", Theme:"4. Role enactment & relational outcomes", StudyID:"5", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill", Focus:"Children"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"6", Design:"Quantitative",  MMAT:2, Perspective:"Children",  Stage:"Not mentioned or across lifespan",  Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"7", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"3. Willingness",  StudyID:"7", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"7", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"7", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"7", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"2. Expectations and implicit delegation of roles to adult children", StudyID:"7", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"4. Family relationships", StudyID:"7", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"1. Cultural taboos and avoidance of death", StudyID:"7", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"8", Design:"Qualitative",  MMAT:4, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"8", Design:"Qualitative",  MMAT:4, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"2. Expectations and implicit delegation of roles to adult children", StudyID:"8", Design:"Qualitative",  MMAT:4, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"1. Cultural taboos and avoidance of death", StudyID:"8", Design:"Qualitative",  MMAT:4, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"9a", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"9a", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"9a", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"9a", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"9a", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"9b", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"9b", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"9b", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"9b", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"9b", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Individual factors",       Theme:"3. Preparedness and self-efficacy", StudyID:"9b", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"9b", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents & Children"},
{Group:"Attitude and willingness", Theme:"1. Affective Attitude", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"3. Willingness", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"3. Preparedness and self-efficacy", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"4. Prior exposure to death or serious illness", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"2. Expectations and implicit delegation of roles to adult children", StudyID:"10", Design:"Qualitative",  MMAT:1, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"11", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill",              Focus:"Children"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"11", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill",              Focus:"Children"},
{Group:"Individual factors",       Theme:"3. Preparedness and self-efficacy", StudyID:"11", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill",              Focus:"Children"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"11", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill",              Focus:"Children"},
{Group:"Impacts of Communication", Theme:"2. End-of-life Decision-Making", StudyID:"11", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill",              Focus:"Children"},
{Group:"Attitude and willingness", Theme:"3. Willingness", StudyID:"12", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"12", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"12", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"13", Design:"Qualitative",  MMAT:3, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"13", Design:"Qualitative",  MMAT:3, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"14a", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Impacts of Communication", Theme:"2. End-of-life Decision-Making", StudyID:"14a", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Impacts of Communication", Theme:"4. Role enactment & relational outcomes", StudyID:"14a", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Familial factors", Theme:"3. Multiple goals in Communication", StudyID:"14b", Design:"Qualitative",  MMAT:4, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"14c", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"14c", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"14c", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Impacts of Communication", Theme:"4. Role enactment & relational outcomes", StudyID:"14c", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Impacts of Communication", Theme:"2. End-of-life Decision-Making", StudyID:"14d", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Impacts of Communication", Theme:"2. End-of-life Decision-Making", StudyID:"14e", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Impacts of Communication", Theme:"4. Role enactment & relational outcomes", StudyID:"14e", Design:"Quantitative",  MMAT:3, Perspective:"Both",  Stage:"Healthy",              Focus:"Parents & Children"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"15", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"15", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"15", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"15", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"15", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Familial factors", Theme:"5. Family norms and communication patterns", StudyID:"15", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"16", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill",              Focus:"Children"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"16", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill",              Focus:"Children"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"16", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"EOL or terminally ill",              Focus:"Children"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"17", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"4. Role enactment & relational outcomes", StudyID:"17", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"18", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"3. Willingness", StudyID:"18", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"18", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"18", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"18", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"4. Prior exposure to death or serious illness", StudyID:"18", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"19", Design:"Quantitative",  MMAT:3, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"20", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"20", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"2. Expectations and implicit delegation of roles to adult children", StudyID:"20", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"1. Cultural taboos and avoidance of death", StudyID:"20", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"21", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"21", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"21", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Cultural/Societal factors", Theme:"2. Social expectations of roles", StudyID:"21", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Impacts of Communication", Theme:"4. Role enactment & relational outcomes", StudyID:"21", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Familial factors", Theme:"3. Multiple goals in Communication", StudyID:"22", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"23", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"23", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"23", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"3. Preparedness and self-efficacy", StudyID:"23", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"4. Prior exposure to death or serious illness", StudyID:"23", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"23", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"24", Design:"Qualitative",  MMAT:3, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"3. Willingness", StudyID:"25a", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"25a", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"25a", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"25a", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"25a", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"3. Willingness", StudyID:"25b", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"25b", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"25b", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"25b", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"25b", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"1. Affective Attitude",  StudyID:"26", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"26", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"26", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"1. Cultural taboos and avoidance of death", StudyID:"26", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"2. End-of-life Decision-Making", StudyID:"26", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"27", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"1. Cultural taboos and avoidance of death", StudyID:"27", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"28", Design:"Quantitative",  MMAT:5, Perspective:"Children",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"28", Design:"Quantitative",  MMAT:5, Perspective:"Children",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"28", Design:"Quantitative",  MMAT:5, Perspective:"Children",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"29", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"29", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"30", Design:"Quantitative",  MMAT:2, Perspective:"Children",  Stage:"Healthy",              Focus:"Children"},
{Group:"Attitude and willingness", Theme:"1. Affective Attitude", StudyID:"31", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"31", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Familial factors", Theme:"3. Multiple goals in Communication", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Familial factors", Theme:"5. Family norms and communication patterns", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"1. Cultural taboos and avoidance of death", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"2. Social expectations of roles", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"2. End-of-life Decision-Making", StudyID:"32", Design:"Qualitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"33", Design:"Mixed-Methods",  MMAT:2, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"3. Willingness", StudyID:"33", Design:"Mixed-Methods",  MMAT:2, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"33", Design:"Mixed-Methods",  MMAT:2, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"33", Design:"Mixed-Methods",  MMAT:2, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"4. Prior exposure to death or serious illness", StudyID:"33", Design:"Mixed-Methods",  MMAT:2, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Familial factors", Theme:"5. Family norms and communication patterns", StudyID:"33", Design:"Mixed-Methods",  MMAT:2, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"2. End-of-life Decision-Making", StudyID:"33", Design:"Mixed-Methods",  MMAT:2, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"34", Design:"Quantitative",  MMAT:4, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"3. Preparedness and self-efficacy", StudyID:"35", Design:"Quantitative",  MMAT:2, Perspective:"Children",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"35", Design:"Quantitative",  MMAT:2, Perspective:"Children",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"35", Design:"Quantitative",  MMAT:2, Perspective:"Children",  Stage:"Deceased",              Focus:"Other family member"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"36", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"36", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"37", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"3. Preparedness and self-efficacy", StudyID:"37", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"37", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"37", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"38", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"38", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"39a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"39a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"39a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"39a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"3. Adjustment and Coping", StudyID:"39a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"39b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"39b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"39b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"39b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"39b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"39b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"3. Adjustment and Coping", StudyID:"39b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"40a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"40a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"40a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"40a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"40a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"40a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Familial factors", Theme:"4. Family relationships", StudyID:"40a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Familial factors", Theme:"5. Family norms and communication patterns", StudyID:"40a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"40a", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"EOL or terminally ill",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"40b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"40b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"40b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"40b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"40b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"2. End-of-life Decision-Making", StudyID:"40b", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"1. Affective Attitude", StudyID:"41", Design:"Qualitative",  MMAT:4, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"41", Design:"Qualitative",  MMAT:4, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"41", Design:"Qualitative",  MMAT:4, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"3. Preparedness and self-efficacy", StudyID:"41", Design:"Qualitative",  MMAT:4, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"42", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"4. Family relationships", StudyID:"42", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"2. Social expectations of roles", StudyID:"42", Design:"Qualitative",  MMAT:5, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"43", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"43", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"2. Expectations and implicit delegation of roles to adult children", StudyID:"43", Design:"Qualitative",  MMAT:4, Perspective:"Parents",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"1. Affective Attitude", StudyID:"44", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"44", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"44", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"44", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"44", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Familial factors", Theme:"5. Family norms and communication patterns", StudyID:"44", Design:"Mixed-Methods",  MMAT:3, Perspective:"Both",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"45", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"45", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"45", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"45", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"45", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"45", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Familial factors", Theme:"4. Family relationships", StudyID:"45", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Cultural/Societal factors", Theme:"1. Cultural taboos and avoidance of death", StudyID:"45", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"45", Design:"Qualitative",  MMAT:3, Perspective:"Both",  Stage:"EOL or terminally ill",              Focus:"Parents & Children"},
{Group:"Attitude and willingness", Theme:"1. Affective Attitude", StudyID:"46", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Healthy",              Focus:"Children"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"46", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Healthy",              Focus:"Children"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"46", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Healthy",              Focus:"Children"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"46", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Healthy",              Focus:"Children"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"47", Design:"Mixed-Methods",  MMAT:3, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"47", Design:"Mixed-Methods",  MMAT:3, Perspective:"Children",  Stage:"Ill or dependent",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"1. General Participation", StudyID:"48", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"48", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"48", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"4. Prior exposure to death or serious illness", StudyID:"48", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"48", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"2. Expectations and implicit delegation of roles to adult children", StudyID:"48", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"1. Cultural taboos and avoidance of death", StudyID:"48", Design:"Qualitative",  MMAT:5, Perspective:"Both",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"1. Affective Attitude", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Attitude and willingness", Theme:"2. Cognitive Attitude",  StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"2. What: Topics", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"3. When: Timing",  StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"4. Who: Initator", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Practice and preference",  Theme:"5. How: Approaches", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"1. Emotional burden", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Individual factors",     Theme:"2. Perceived death imminence & acceptance", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Individual factors",       Theme:"4. Prior exposure to death or serious illness", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"1. Anticipated responses of the communication partner", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"2. Expectations and implicit delegation of roles to adult children", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Familial factors", Theme:"4. Family relationships", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Cultural/Societal factors", Theme:"2. Social expectations of roles", StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"2. End-of-life Decision-Making",  StudyID:"49", Design:"Qualitative",  MMAT:5, Perspective:"Children",  Stage:"Elderly",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"1. Psychological Outcomes", StudyID:"50", Design:"Quantitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"},
{Group:"Impacts of Communication", Theme:"3. Adjustment and Coping", StudyID:"50", Design:"Quantitative",  MMAT:3, Perspective:"Children",  Stage:"Not mentioned or across lifespan",              Focus:"Parents"}
  ];

  /* ===== ColorModes ===== */
  const colorModes = {
    // 1) MMAT：includes Density + tfoot
    mmat: {
      label: "MMAT Quality",
      fullTitle: "Mapping of Included Studies Across Findings by MMAT Quality Appraisal, Data Richness, and Data Density",
      legend: [
        {name:"0–1 criteria met", color:"var(--q-low)"},
        {name:"2–3 criteria met", color:"var(--q-mid)"},
        {name:"4–5 criteria met", color:"var(--q-high)"}
      ],
      colorOf: r => { const x=Number(r.MMAT); if(isNaN(x)) return "#ccc"; if(x<=1)return"var(--q-low)"; if(x<=3)return"var(--q-mid)"; return"var(--q-high)"; },
      sideCols: [
        {title:"0–1",   calc:(arr)=>arr.filter(r=>Number(r.MMAT)<=1).length},
        {title:"2–3",   calc:(arr)=>arr.filter(r=>{const x=Number(r.MMAT);return x>=2 && x<=3;}).length},
        {title:"4–5",   calc:(arr)=>arr.filter(r=>Number(r.MMAT)>=4).length},
        {title:"Density", titleHtml:"Density<sup>1</sup>", calc:(arr, totalStudies)=> totalStudies? (arr.length/totalStudies).toFixed(1):""}
      ],
      showFoot: true
    },

// 2) Study Design：表头=按研究设计；格子=优先按 DataType（缺失则回落到研究设计）
design: {
  label: "Study Design",
  fullTitle: "Mapping of Included Studies Across Findings by Study Designs",
  legend: [
    {name:"Qualitative",  color:"var(--qual)"},
    {name:"Quantitative", color:"var(--quant)"},
    {name:"Mixed-Methods",color:"var(--mix)"}
  ],
  // 表头（StudyID）始终按研究设计上色
  headColorOf: r => ({
    "Qualitative":"var(--qual)",
    "Quantitative":"var(--quant)",
    "Mixed-Methods":"var(--mix)"
  }[r.Design] || "#ccc"),

  // 单元格：若有 DataType，则按 DataType；否则回落到研究设计
  // 允许 DataType 写法：Qualitative / Quantitative / Mixed 或 Mixed-Methods
  cellColorOf: r => {
    const dt = (r.DataType || "").trim();
    if (dt) {
      return ({
        "Qualitative":"var(--qual)",
        "Quantitative":"var(--quant)",
        "Mixed":"var(--mix)",
        "Mixed-Methods":"var(--mix)"
      }[dt] || "#ccc");
    }
    // 回落到研究设计
    return ({
      "Qualitative":"var(--qual)",
      "Quantitative":"var(--quant)",
      "Mixed-Methods":"var(--mix)"
    }[r.Design] || "#ccc");
  },

  // 兼容：颜色排序等场景仍以“研究设计”作为分组依据
  colorOf: r => ({
    "Qualitative":"var(--qual)",
    "Quantitative":"var(--quant)",
    "Mixed-Methods":"var(--mix)"
  }[r.Design] || "#ccc"),

  sideCols: [
    {title:"Qual",  calc:(arr)=>arr.filter(r=>r.Design==="Qualitative").length},
    {title:"Quant", calc:(arr)=>arr.filter(r=>r.Design==="Quantitative").length},
    {title:"MM",    calc:(arr)=>arr.filter(r=>r.Design==="Mixed-Methods").length}
  ],
  showFoot: false
},

   // 3) Participant perspectives
persp: {
  label: "Participant perspectives",
  fullTitle: "Mapping of Included Studies Across Findings by Participant Perspectives",
  legend: [
    {name:"Parents",  color:"var(--pp-parent)"},
    {name:"Children", color:"var(--pp-child)"},
    {name:"Both",     color:"var(--pp-both)"}
  ],

  // ✅ 新增：单元格颜色优先按 DataPerspective；缺失则回落到 Perspective
  cellColorOf: r => {
    const dp = (r.DataPerspective || "").trim();
    if (dp) {
      return ({
        "Parents":"var(--pp-parent)",
        "Children":"var(--pp-child)",
        "Both":"var(--pp-both)"
      }[dp] || "#ccc");
    }
    // 回落
    return ({
      "Parents":"var(--pp-parent)",
      "Children":"var(--pp-child)",
      "Both":"var(--pp-both)"
    }[r.Perspective] || "#ccc");
  },

  // 兼容：排序/表头分桶仍以汇总 Perspective（与你在 design 视图的做法一致）
  colorOf: r => ({
    "Parents":"var(--pp-parent)",
    "Children":"var(--pp-child)",
    "Both":"var(--pp-both)"
  }[r.Perspective] || "#ccc"),

  sideCols: [
    {title:"Parents",  calc:(arr)=>arr.filter(r=>r.Perspective==="Parents").length},
    {title:"Children", calc:(arr)=>arr.filter(r=>r.Perspective==="Children").length},
    {title:"Both",     calc:(arr)=>arr.filter(r=>r.Perspective==="Both").length}
  ],
  showFoot: false
},


    // 4) Stage of life/illness
    stage: {
      label: "Stage of life/illness",
      fullTitle: "Mapping of Included Studies Across Findings by Stage of Life/Illness of the Focused Person",
      legend: [
        {name:"Healthy",               color:"var(--st-healthy)"},
        {name:"Elderly",               color:"var(--st-elderly)"},
        {name:"Ill or dependent",      color:"var(--st-ill)"},
        {name:"EOL or terminally ill", color:"var(--st-eol)"},
        {name:"Deceased",              color:"var(--st-deceased)"},
        {name:"Not mentioned or across lifespan",         color:"var(--st-na)"}
      ],
      colorOf: r => ({
        "Healthy":"var(--st-healthy)",
        "Elderly":"var(--st-elderly)",
        "Ill or dependent":"var(--st-ill)",
        "EOL or terminally ill":"var(--st-eol)",
        "Deceased":"var(--st-deceased)",
        "Not mentioned or across lifespan":"var(--st-na)"
      }[r.Stage] || "#ccc"),
      sideCols: [
        {title:"Healthy",               calc:(arr)=>arr.filter(r=>r.Stage==="Healthy").length},
        {title:"Elderly",               calc:(arr)=>arr.filter(r=>r.Stage==="Elderly").length},
        {title:"Ill or dependent",      calc:(arr)=>arr.filter(r=>r.Stage==="Ill or dependent").length},
        {title:"EOL or terminally ill", calc:(arr)=>arr.filter(r=>r.Stage==="EOL or terminally ill").length},
        {title:"Deceased",              calc:(arr)=>arr.filter(r=>r.Stage==="Deceased").length},
        {title:"Not mentioned or across lifespan",         calc:(arr)=>arr.filter(r=>r.Stage==="Not mentioned or across lifespan").length}
      ],
      showFoot: false
    },

// 5) Focus of death & dying communication
focus: {
  label: "Focus of death & dying communication",
  fullTitle: "Mapping of Included Studies Across Findings by the Focus of Death and Dying Communication",
  legend: [
    {name:"Parents",            color:"var(--fc-parents)"},
    {name:"Children",           color:"var(--fc-children)"},
    {name:"Parents & Children", color:"var(--fc-both)"},
    {name:"Other family member",color:"var(--fc-other)"}
  ],

  // ✅ 新增：单元格颜色优先按 DataFocus；缺失则回落到 Focus
  cellColorOf: r => {
    const df = (r.DataFocus || "").trim();
    if (df) {
      return ({
        "Parents":"var(--fc-parents)",
        "Children":"var(--fc-children)",
        "Parents & Children":"var(--fc-both)",
        "Other family member":"var(--fc-other)"
      }[df] || "#ccc");
    }
    // 回落
    return ({
      "Parents":"var(--fc-parents)",
      "Children":"var(--fc-children)",
      "Parents & Children":"var(--fc-both)",
      "Other family member":"var(--fc-other)"
    }[r.Focus] || "#ccc");
  },

  // 兼容：排序/表头分桶仍以汇总 Focus
  colorOf: r => ({
    "Parents":"var(--fc-parents)",
    "Children":"var(--fc-children)",
    "Parents & Children":"var(--fc-both)",
    "Other family member":"var(--fc-other)"
  }[r.Focus] || "#ccc"),

  sideCols: [
    {title:"Parents",            calc:(arr)=>arr.filter(r=>r.Focus==="Parents").length},
    {title:"Children",           calc:(arr)=>arr.filter(r=>r.Focus==="Children").length},
    {title:"Parents & Children", calc:(arr)=>arr.filter(r=>r.Focus==="Parents & Children").length},
    {title:"Other family member",calc:(arr)=>arr.filter(r=>r.Focus==="Other family member").length}
  ],
  showFoot: false
}

  };

  /* ===== Utility function ===== */
  function uniq(arr){ return Array.from(new Set(arr)); }
  function byStudyId(a,b){
    const pa = String(a).trim().match(/^(\d+)([a-z]*)$/i) || [null, a, ""];
    const pb = String(b).trim().match(/^(\d+)([a-z]*)$/i) || [null, b, ""];
    const na = isFinite(+pa[1]) ? +pa[1] : Number.MAX_SAFE_INTEGER;
    const nb = isFinite(+pb[1]) ? +pb[1] : Number.MAX_SAFE_INTEGER;
    if (na !== nb) return na - nb;
    const sa = (pa[2]||"").toLowerCase();
    const sb = (pb[2]||"").toLowerCase();
    return sa.localeCompare(sb);
  }
  function byText(a,b){ return (''+a).localeCompare((''+b), undefined, {numeric:true}); }

// === Assign each study a “color-bucket” index under the current mode (smaller = farther left).===
function bucketIndexForRecord(rec, modeKey){
  switch(modeKey){
    case 'mmat': {
      const x = Number(rec.MMAT);
      if (isNaN(x)) return 99;
      if (x <= 1) return 0;       // 0–1
      if (x <= 3) return 1;       // 2–3
      return 2;                   // 4–5
    }
    case 'design': {
      // Keep the same order as the legend：Qualitative, Quantitative, Mixed-Methods
      const m = { 'Qualitative':0, 'Quantitative':1, 'Mixed-Methods':2 };
      return (rec.Design in m) ? m[rec.Design] : 99;
    }
    case 'persp': {
      // Parents, Children, Both
      const m = { 'Parents':0, 'Children':1, 'Both':2 };
      return (rec.Perspective in m) ? m[rec.Perspective] : 99;
    }
    case 'stage': {
      // Healthy, Elderly, Ill or dependent, EOL..., Deceased, Not mentioned or across lifespan
      const m = {
        'Healthy':0, 'Elderly':1, 'Ill or dependent':2,
        'EOL or terminally ill':3, 'Deceased':4, 'Not mentioned or across lifespan':5
      };
      return (rec.Stage in m) ? m[rec.Stage] : 99;
    }
    case 'focus': {
      // Parents, Children, Parents & Children, Other family member
      const m = {
        'Parents':0, 'Children':1, 'Parents & Children':2, 'Other family member':3
      };
      return (rec.Focus in m) ? m[rec.Focus] : 99;
    }
    default:
      return 99;
  }
}

// ===Pick one representative record for each StudyID (to decide its color bucket) ===
function representativeByStudy(rows){
  const rep = {};
  rows.forEach(r=>{
    const sid = String(r.StudyID).trim();
    if (!rep[sid]) rep[sid] = r; // Use the first occurrence as the representative
  });
  return rep;
}

// === Return the array of study-column order based on currentColOrder ===
function getStudiesOrdered(rows, order, modeKey){
  const ids = uniq(rows.map(r=>String(r.StudyID).trim()));
  if (order === 'id'){
    // Original ID order
    return ids.sort(byStudyId);
  }
  // Group by color (bucket order), then by ID
  const rep = representativeByStudy(rows);
  return ids.sort((a,b)=>{
    const ra = rep[a], rb = rep[b];
    const ba = bucketIndexForRecord(ra || {}, modeKey);
    const bb = bucketIndexForRecord(rb || {}, modeKey);
    if (ba !== bb) return ba - bb;
    return byStudyId(a,b); // Within the same bucket, still sort by ID
  });
}

  /* ===== Build/render the table ===== */
  let currentMode = 'mmat'; // Default to MMAT

 let currentColOrder = 'id'; // 'id' = by study ID; color = group by color

  const tbl = document.getElementById('matrix');

  function buildTable(){
    tbl.innerHTML = "";

    // Clean/normalize
    rows = rows.filter(r=> (r.Group||"") && (r.Theme||"") && (r.StudyID||""));

    const studies = getStudiesOrdered(rows, currentColOrder, currentMode);
    const totalStudies = studies.length;

    // Group
    const groups = {};
    rows.forEach(r=>{
      if(!groups[r.Group]) groups[r.Group]=new Set();
      groups[r.Group].add(r.Theme);
    });

// ===== Fixed Group ordering (groups not rendered as columns stay in alphabetical order and come after the columnized ones)=====
// Use your desired display order (case-insensitive)
const DESIRED_ORDER = [
  "Attitude and Willingness",
  "Practice and Preference",
  "Individual Factors",
  "Familial Factors",
  "Cultural/Societal Factors",
  "Impacts of Communication" // Last
];

// In the data, the “influencing factors” group names are long; map them to short aliases for sorting
const ALIASES = {
  "impacts of varied communication behaviors and characteristics": "Impacts of Communication"
};

// Compute the sort weight for Every group; assign a very large rank to groups not rendered as columns
const rank = (g) => {
  const normalized = g.toLowerCase();
  const canonical = (ALIASES[normalized] || g).toLowerCase();
  const order = DESIRED_ORDER.map(s => s.toLowerCase());
  const idx = order.indexOf(canonical);
  return idx === -1 ? 999 : idx;
};

// Sort by rank (custom order) first, then by alphabetical order for a stable tie-break
const groupOrder = Object.keys(groups).sort((a, b) => {
  const ra = rank(a), rb = rank(b);
  if (ra !== rb) return ra - rb;
  return byText(a, b);
});
// ⬆️ End of fixed ordering code


    // Index
    const index = {};
    rows.forEach(r=>{ index[`${r.Group}|||${r.Theme}|||${r.StudyID}`] = r; });

    const mode = colorModes[currentMode];

const noteBox = document.getElementById('note');
if (currentMode === 'mmat') {
  noteBox.style.display = 'block';
  noteBox.innerHTML =
    'NOTE: <sup>1</sup> Data density = Number of reports contributing to the theme / Total number of included reports; ' +
    '<sup>2</sup> Data richness = Number of themes contributed by the study / Total number of themes';
} else {
  noteBox.style.display = 'none';
  noteBox.innerHTML = '';
}

document.getElementById('view-title').textContent = colorModes[currentMode].fullTitle;
document.title = colorModes[currentMode].fullTitle; // If you also want the browser tab title to update

    /* colgroup：Fixed ColumnWidth */
    const colgroup = document.createElement('colgroup');
    const cgGroup = document.createElement('col');  cgGroup.style.width='var(--w-group)'; colgroup.appendChild(cgGroup);
    const cgTheme = document.createElement('col');  cgTheme.style.width='var(--w-theme)'; colgroup.appendChild(cgTheme);
    studies.forEach(()=>{ const c=document.createElement('col'); c.className='col-study'; colgroup.appendChild(c); });
    mode.sideCols.forEach(()=>{ const c=document.createElement('col'); colgroup.appendChild(c); });
    tbl.appendChild(colgroup);

    /* thead */
    const thead = document.createElement('thead');
    const tr0 = document.createElement('tr');
    const thCorner = document.createElement('th'); thCorner.className='corner rowhead'; thCorner.textContent='Group';
    const thCorner2 = document.createElement('th'); thCorner2.className = 'corner2 rowhead second diag'; thCorner2.innerHTML = '<div class="diagbox"><span class="bl">Theme</span><span class="tr">Report ID</span></div>';
    tr0.appendChild(thCorner); tr0.appendChild(thCorner2);
    /* First pick one representative record for Every Study (these attributes are consistent in your data) */
const studyRep = {};
rows.forEach(r => {
  const sid = String(r.StudyID).trim();
  if (!studyRep[sid]) studyRep[sid] = r;  // Use the first occurrence as the representative.
});

/* Color the header for every Study Code */
studies.forEach(id => {
  const th = document.createElement('th');
  th.className = 'col-study study-head';
  th.textContent = id;

  const rec = studyRep[id];
  if (rec) {
    // Study Design 视图：表头用 headColorOf；其他视图继续用 colorOf
    const headBg = (mode.headColorOf ? mode.headColorOf(rec) : mode.colorOf(rec));
    th.style.background = headBg;

    // Tooltip：补充 DataType / DataPerspective / DataFocus（若存在）
    const dt = rec.DataType ? `\nDataType: ${rec.DataType}` : "";
    const dp = rec.DataPerspective ? `\nDataPerspective: ${rec.DataPerspective}` : "";
    const df = rec.DataFocus ? `\nDataFocus: ${rec.DataFocus}` : "";

    th.title = `Study: ${id}\nDesign: ${rec.Design || '-'}${dt}\nMMAT: ${rec.MMAT ?? '-'}\nPerspective: ${rec.Perspective || '-'}${dp}\nStage: ${rec.Stage || '-'}\nFocus: ${rec.Focus || '-'}${df}`;
  }

  tr0.appendChild(th);
});


    mode.sideCols.forEach(c=>{ const th=document.createElement('th'); th.innerHTML = c.titleHtml ?? c.title; tr0.appendChild(th); });
    thead.appendChild(tr0);
    tbl.appendChild(thead);

    /* tbody */
    const tbody = document.createElement('tbody');
    groupOrder.forEach(g=>{
      const themes = Array.from(groups[g]).sort(byText);
      themes.forEach((t, idx)=>{
        const tr = document.createElement('tr');
    tr.dataset.group = g;     // Tag each row with its group name for later unified row-height calculation

// ⭐ Row hover highlight: toggle the hl class on mouseenter/mouseleave of the entire row
tr.addEventListener('mouseenter', () => {
  tr.classList.add('hl');
});
tr.addEventListener('mouseleave', () => {
  tr.classList.remove('hl');
});

        if(idx===0){
          const tdg = document.createElement('td');
          tdg.className = 'rowhead';
          tdg.rowSpan = themes.length;
          tdg.textContent = g;
          tr.appendChild(tdg);
        }

        const tdt = document.createElement('td');
        tdt.className = 'rowhead second';
        tdt.textContent = t;
        tr.appendChild(tdt);

// Optional: if you want the highlight to clear when the cursor leaves any part of the row，
// Add a mouseleave handler on the tr as a fallback to prevent lingering highlight during fast movement
tr.addEventListener('mouseleave', () => {
  tr.classList.remove('hl');
});

        const rowRecs = [];
        studies.forEach(id=>{
          const td = document.createElement('td');
          td.className = 'cell col-study';
          const rec = index[`${g}|||${t}|||${id}`];
if(rec){
  rowRecs.push(rec);
  const mk = document.createElement('span'); 
  mk.className = 'mark';

  // Study Design 视图：格子按 cellColorOf（DataType优先，缺失则回落Design）
  // 其他视图保持原来的 mode.colorOf
  const cellBg = (mode.cellColorOf ? mode.cellColorOf(rec) : mode.colorOf(rec));
  mk.style.background = cellBg;

// Tooltip 里也补充 DataType / DataPerspective / DataFocus 信息（若有）
const dt = rec.DataType ? `\nDataType: ${rec.DataType}` : "";
const dp = rec.DataPerspective ? `\nDataPerspective: ${rec.DataPerspective}` : "";
const df = rec.DataFocus ? `\nDataFocus: ${rec.DataFocus}` : "";

td.title = `Group: ${g}\nTheme: ${t}\nStudy: ${id}\nDesign: ${rec.Design||'-'}${dt}\nMMAT: ${rec.MMAT ?? '-'}\nPerspective: ${rec.Perspective||'-'}${dp}\nStage: ${rec.Stage||'-'}\nFocus: ${rec.Focus||'-'}${df}`;


  td.appendChild(mk);
}else{
  td.classList.add('empty');
}

          tr.appendChild(td);
        });

        mode.sideCols.forEach(c=>{
          const td = document.createElement('td'); td.className='num';
          const val = c.calc.length>=2 ? c.calc(rowRecs, totalStudies) : c.calc(rowRecs);
          td.textContent = val===0 ? "0" : (val ?? "");
          tr.appendChild(td);
        });

        tbody.appendChild(tr);
      });
    });
    tbl.appendChild(tbody);

    /* tfoot：Show only in MMAT mode and merge the first two columns */
    if (mode.showFoot){
      const tfoot = document.createElement('tfoot');

      // per-study counts
      const perStudyCount = Object.fromEntries(studies.map(s=>[s,0]));
      rows.forEach(r=>{ perStudyCount[r.StudyID] = (perStudyCount[r.StudyID]||0)+1; });

      // Themes contributed (n)
      const f1 = document.createElement('tr');
      const f1h=document.createElement('th');
      f1h.className='rowhead span2';
      f1h.colSpan=2;
      f1h.textContent='Themes contributed (n)';
      f1.appendChild(f1h);
      studies.forEach(id=>{
        const td=document.createElement('td');
        td.className='num';
        td.textContent=perStudyCount[id]||0;
        f1.appendChild(td);
      });
      mode.sideCols.forEach(()=>{
        const td=document.createElement('td');
        td.textContent='';
        f1.appendChild(td);
      });
      tfoot.appendChild(f1);

      // Data richness
      const f2 = document.createElement('tr');
      const f2h=document.createElement('th');
      f2h.className='rowhead span2';
      f2h.colSpan=2;
      f2h.innerHTML='Data richness<sup>2</sup>';
      f2.appendChild(f2h);

      const totalThemes = uniq(rows.map(r=>`${r.Group}|||${r.Theme}`)).length;
      studies.forEach(id=>{
        const n = perStudyCount[id]||0;
        const td=document.createElement('td');
        td.className='num';
        td.textContent = totalThemes? (n/totalThemes).toFixed(1) : '';
        f2.appendChild(td);
      });
      mode.sideCols.forEach(()=>{
        const td=document.createElement('td');
        td.textContent='';
        f2.appendChild(td);
      });
      tfoot.appendChild(f2);

      tbl.appendChild(tfoot);
    }

    // Normalize row heights after the entire table structure is inserted
    requestAnimationFrame(() => {
      equalizeAllThemeRowHeights();
    });

    // Refresh the legend
    rebuildLegend();
  }

  function rebuildLegend(){
    const box = document.getElementById('legend');
    box.innerHTML='';
    colorModes[currentMode].legend.forEach(it=>{
      const d=document.createElement('div'); d.className='item';
      const sw=document.createElement('span'); sw.className='sw'; sw.style.background=it.color;
      const tx=document.createElement('span'); tx.textContent=it.name;
      d.appendChild(sw); d.appendChild(tx); box.appendChild(d);
    });
  }

  // Mode switching
  document.querySelectorAll('.btn[data-mode]').forEach(btn=>{
    btn.addEventListener('click', e=>{
      document.querySelectorAll('.btn[data-mode]').forEach(b=>b.classList.remove('active'));
      e.currentTarget.classList.add('active');
      currentMode = e.currentTarget.dataset.mode;
      buildTable();
    });
  });

// —— Two buttons for column sorting ——

// Sort by color groups
document.getElementById('btnSortColor').addEventListener('click', ()=>{
  currentColOrder = 'color';
  // Button styling optional
  document.getElementById('btnSortColor').classList.add('active');
  document.getElementById('btnSortReset').classList.remove('active');
  buildTable();
});

// Restore the initial order by Study ID
document.getElementById('btnSortReset').addEventListener('click', ()=>{
  currentColOrder = 'id';
  document.getElementById('btnSortReset').classList.add('active');
  document.getElementById('btnSortColor').classList.remove('active');
  buildTable();
});

// When switching color modes, if currently sorting by color, re-sort by the new mode’s color buckets
// buildTable() is already called in your existing mode switch, no extra handling needed; just sync the button state here

// Debounce to avoid frequent recalculation on window resize
function debounce(fn, wait=100){
  let t;
  return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args), wait); };
}

function equalizeAllThemeRowHeights(){
  const tbody = document.querySelector('#matrix tbody');
  if(!tbody) return;

  const trs = Array.from(tbody.querySelectorAll('tr'));
  trs.forEach(tr => tr.style.height = ''); // Clean first

  // Measure only the second column (Theme) cells
  const themeCells = trs.map(tr => tr.querySelector('td.rowhead.second')).filter(Boolean);
  if(themeCells.length === 0) return;

  const maxH = Math.max(22, ...themeCells.map(td => td.scrollHeight));
  trs.forEach(tr => tr.style.height = maxH + 'px');
}


  // Initial render
  buildTable();
window.addEventListener('resize', debounce(equalizeAllThemeRowHeights, 150));
  </script>

<script>
(function () {
  const overlay  = document.getElementById('matrix-intro');
  const startBtn = document.getElementById('mx-intro-start-btn');
  const dontShow = document.getElementById('mx-intro-dontshow');

    const closeX = document.getElementById('intro-close');
  if (closeX) {
    closeX.addEventListener('click', () => {
      if (dontShow && dontShow.checked) localStorage.setItem(KEY, '1');
      hideOverlay();
    });
  }

  // 背景区域下滑手势关闭（避免与卡片内滚动冲突：只在点到背景时触发）
  let touchStartY = null;
  overlay.addEventListener('touchstart', (e) => {
    if (e.target === overlay && e.touches && e.touches[0]) {
      touchStartY = e.touches[0].clientY;
    }
  }, {passive:true});

  overlay.addEventListener('touchmove', (e) => {
    if (touchStartY == null || e.target !== overlay) return;
    const dy = e.touches[0].clientY - touchStartY;
    if (dy > 80) { // 下滑超过 80px 认为想关闭
      if (dontShow && dontShow.checked) localStorage.setItem(KEY, '1');
      hideOverlay();
      touchStartY = null;
    }
  }, {passive:true});

  overlay.addEventListener('touchend', () => { touchStartY = null; });

  if (!overlay) return;

  const KEY = 'matrix-intro-hide';  // 与蜘蛛图的 key 区分开
  const hide = (localStorage.getItem(KEY) === '1');

  function showOverlay() {
    overlay.style.display = 'flex';
    document.body.classList.add('no-scroll');
    try { startBtn && startBtn.focus(); } catch(_) {}
  }
  function hideOverlay() {
    overlay.style.display = 'none';
    document.body.classList.remove('no-scroll');
  }

  // 初次进入或未勾选“Don’t show” → 显示
  if (!hide) showOverlay();

  // 开始按钮
  startBtn && startBtn.addEventListener('click', () => {
    if (dontShow && dontShow.checked) localStorage.setItem(KEY, '1');
    hideOverlay();
  });

  // ESC 关闭
  document.addEventListener('keydown', (e) => {
    if (overlay.style.display !== 'none' && (e.key === 'Escape' || e.key === 'Esc')) hideOverlay();
  });

  // 点击遮罩空白处关闭
  overlay.addEventListener('click', (e) => {
    if (e.target === overlay) {
      if (dontShow && dontShow.checked) localStorage.setItem(KEY, '1');
      hideOverlay();
    }
  });
})();
</script>

<script>
(function () {
  const table = document.getElementById('matrix');
  if (!table) return;

  function ensureStickyHeaderOnce() {
    if (!table.tHead) {
      const firstRow = table.querySelector(':scope > tr, :scope > tbody > tr');
      if (firstRow) {
        const thead = table.createTHead();
        thead.appendChild(firstRow);
      } else {
        return;
      }
    }
    table.tHead.querySelectorAll('th').forEach(th => {
      th.style.position = 'sticky';
      th.style.top = '0';
      th.style.zIndex = '10';
      if (!th.style.background) th.style.background = '#fafbfe';
    });
  }

  // 先跑一次（如果已经渲染了）
  ensureStickyHeaderOnce();

  // 监听后续重绘（排序/重置）
  const obs = new MutationObserver(ensureStickyHeaderOnce);
  obs.observe(table, { childList: true, subtree: true });
})();
</script>

</body>
</html>

